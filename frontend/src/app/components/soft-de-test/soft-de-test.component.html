<div class="dashboard-container">
  <!-- Titre principal -->
  <h1 class="dashboard-title">
    <i class="fas fa-chart-line"></i> Dashboard Soft de Test
  </h1>
  <!-- Menu de navigation -->
<div class="menu-container">
  <div class="menu-buttons">
    <a routerLink="/dashboard-quoi-tester" class="menu-btn">
      <i class="bi bi-tools"></i> Quoi Tester
    </a>
    <a routerLink="/dashboard-soft-de-test" class="menu-btn">
      <i class="bi bi-cpu"></i> Status Soft
    </a>
    <a routerLink="/planning" class="menu-btn">
      <i class="bi bi-gear-wide-connected"></i> Status Mécanique
    </a>
    <a routerLink="/dashboard-budget" class="menu-btn">
      <i class="bi bi-cash-coin"></i> Budget Planifié
    </a>
    <a routerLink="/dashboard-suivi-budget" class="menu-btn">
      <i class="bi bi-clipboard-data"></i> Suivi Budget
    </a>
  </div>
</div>



<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">


  <!-- Filtres -->
  <section class="filters-section">
    <div class="filters-grid">
      <div class="filter-card">
        <label class="filter-label"><i class="fas fa-project-diagram"></i> Projet</label>
        <select class="filter-select" [(ngModel)]="selectedProject" (change)="applyFilters()">
          <option value="">Tous les projets</option>
          <option *ngFor="let p of projetOptions" [value]="p">{{ p }}</option>
        </select>
      </div>
      

      <div class="filter-card">
        <label class="filter-label"><i class="fas fa-layer-group"></i> Famille Technique</label>
        <select class="filter-select" [(ngModel)]="selectedFamille" (change)="applyFilters()">
          <option value="">Toutes les familles</option>
          <option *ngFor="let f of familleOptions" [value]="f">{{ f }}</option>
        </select>
      </div>
    </div>
      <div class="export-buttons mb-4">
    <button class="btn btn-pdf" (click)="downloadPDF()">
      <i class="bi bi-file-earmark-pdf"></i> Export PDF
    </button>
  </div>
  </section>

  <!-- KPI -->
  <section class="kpi-section">
    <div class="kpi-grid">
      <div class="kpi-card success">
        <div class="kpi-header">
          <div class="kpi-icon"><i class="fas fa-check-circle"></i></div>
          <div>
            <h4 class="kpi-title">Disponible</h4>
            <p class="kpi-value">{{ stats.disponible }}</p>
            <p class="kpi-percentage">{{ (stats.disponible / stats.total * 100 || 0) | number:'1.0-0' }}%</p>
          </div>
        </div>
      </div>

      <div class="kpi-card danger">
        <div class="kpi-header">
          <div class="kpi-icon"><i class="fas fa-times-circle"></i></div>
          <div>
            <h4 class="kpi-title">Non supporté</h4>
            <p class="kpi-value">{{ stats.nonSupporte }}</p>
            <p class="kpi-percentage">{{ (stats.nonSupporte / stats.total * 100 || 0) | number:'1.0-0' }}%</p>
          </div>
        </div>
      </div>

      <div class="kpi-card warning">
        <div class="kpi-header">
          <div class="kpi-icon"><i class="fas fa-hourglass-half"></i></div>
          <div>
            <h4 class="kpi-title">En attente</h4>
            <p class="kpi-value">{{ stats.enAttente }}</p>
            <p class="kpi-percentage">{{ (stats.enAttente / stats.total * 100 || 0) | number:'1.0-0' }}%</p>
          </div>
        </div>
      </div>

      <div class="kpi-card info">
        <div class="kpi-header">
          <div class="kpi-icon"><i class="fas fa-question-circle"></i></div>
          <div>
            <h4 class="kpi-title">Non vérifié</h4>
            <p class="kpi-value">{{ stats.nonVerifie }}</p>
            <p class="kpi-percentage">{{ (stats.nonVerifie / stats.total * 100 || 0) | number:'1.0-0' }}%</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Graphiques -->
  <section class="charts-section">
    <div class="charts-grid">
      <div class="chart-container">
        <div class="chart-header">
          <h3><i class="fas fa-chart-pie"></i> Répartition par statut</h3>
        </div>
        <div class="chart-wrapper"><canvas id="statusChart"></canvas></div>
      </div>

      <div class="chart-container">
        <div class="chart-header">
          <h3><i class="fas fa-chart-bar"></i> Fonctions par famille technique</h3>
        </div>
        <div class="chart-wrapper"><canvas id="familleChart"></canvas></div>
      </div>

  <div class="chart-container">
        <div class="chart-header">
          <h3><i class="fas fa-chart-bar"></i> Répartition par projet</h3>
        </div>
        <div class="chart-wrapper"><canvas id="projectChart"></canvas></div>
      </div>    
    </div>
  </section>

<!-- Tableau de données -->
<section class="table-section">
  <div class="chart-header">
    <h3><i class="fas fa-table"></i> Détail des fonctions</h3>
  </div>
  <div class="table-responsive">
    <table class="data-table">
      <thead>
        <tr>
          <th>Famille Technique</th>
          <th>Fonctions à Tester</th>
          <th>État</th>
          <th>Commentaire</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of filteredData">
          <td>{{ item.familleTechnique || '-' }}</td>
          <td>{{ item.fonctionsATester || '-' }}</td>
          <td>
            <span class="status-badge" [style.background]="getEtatAffichage(item).color">
              {{ getEtatAffichage(item).icon }} {{ getEtatAffichage(item).label }}
            </span>
          </td>
          <td class="comment-cell">{{ item.commentaire || '-' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

</div>